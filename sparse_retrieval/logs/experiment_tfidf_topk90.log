10/14/2024 14:44:42 - INFO - __main__ -    Starting Sparse Retrieval System.
10/14/2024 14:44:42 - INFO - __main__ -    Loading tokenizer model: klue/bert-base
10/14/2024 14:44:47 - INFO - __main__ -    Embedding method: tfidf
10/14/2024 14:44:47 - INFO - __main__ -    Top-K: 90
10/14/2024 14:44:47 - INFO - __main__ -    Evaluation method: ['hit', 'mrr']
10/14/2024 14:44:47 - INFO - __main__ -    Loading data.
10/14/2024 14:44:47 - INFO - __main__ -    Loading Wikipedia data from ../../data/wikipedia_documents.json
10/14/2024 14:44:47 - INFO - __main__ -    File size of ../../data/wikipedia_documents.json: 110.0 MB
10/14/2024 14:44:49 - INFO - __main__ -    Length of unique context: 56737
10/14/2024 14:44:49 - INFO - __main__ -    [Load data] done in 1.661 s
10/14/2024 14:44:49 - INFO - __main__ -    Generating sparse embeddings.
10/14/2024 14:44:49 - INFO - __main__ -    Loading TF-IDF pickle files.
10/14/2024 14:44:49 - INFO - __main__ -    File size of tfidf.bin: 40.7 MB
10/14/2024 14:44:49 - INFO - __main__ -    File size of tfidf_sparse_embedding.bin: 217.1 MB
10/14/2024 14:44:51 - INFO - __main__ -    [Generate sparse embeddings] done in 1.995 s
10/14/2024 14:44:51 - INFO - __main__ -    Evaluating retrieval performance.
10/14/2024 14:44:51 - INFO - __main__ -    Loading evaluation dataset from ../../data/train_dataset
10/14/2024 14:44:51 - INFO - __main__ -    Evaluation dataset loaded with 4192 examples.
10/14/2024 14:44:51 - INFO - __main__ -    Retrieving for dataset queries.
10/14/2024 14:45:17 - INFO - __main__ -    [query exhaustive search] done in 26.387 s
Sparse retrieval:   0%|          | 0/4192 [00:00<?, ?it/s]Sparse retrieval:  17%|█▋        | 721/4192 [00:00<00:00, 7206.40it/s]Sparse retrieval:  38%|███▊      | 1599/4192 [00:00<00:00, 8128.97it/s]Sparse retrieval:  59%|█████▉    | 2480/4192 [00:00<00:00, 8438.36it/s]Sparse retrieval:  80%|███████▉  | 3337/4192 [00:00<00:00, 8487.15it/s]Sparse retrieval: 100%|█████████▉| 4186/4192 [00:00<00:00, 3804.30it/s]Sparse retrieval: 100%|██████████| 4192/4192 [00:00<00:00, 4973.48it/s]
10/14/2024 14:45:18 - INFO - __main__ -    Completed retrieval for dataset queries.
10/14/2024 14:45:18 - INFO - __main__ -    Evaluating Hit@k.
10/14/2024 14:45:18 - INFO - __main__ -    Hit@90: 0.8655
10/14/2024 14:45:18 - INFO - __main__ -    [Evaluation hit] done in 27.297 s
10/14/2024 14:45:18 - INFO - __main__ -    Loading evaluation dataset from ../../data/train_dataset
10/14/2024 14:45:18 - INFO - __main__ -    Evaluation dataset loaded with 4192 examples.
10/14/2024 14:45:18 - INFO - __main__ -    Retrieving for dataset queries.
10/14/2024 14:45:45 - INFO - __main__ -    [query exhaustive search] done in 26.349 s
Sparse retrieval:   0%|          | 0/4192 [00:00<?, ?it/s]Sparse retrieval:  20%|██        | 858/4192 [00:00<00:00, 8578.92it/s]Sparse retrieval:  41%|████      | 1725/4192 [00:00<00:00, 8628.18it/s]Sparse retrieval:  63%|██████▎   | 2627/4192 [00:00<00:00, 8803.66it/s]Sparse retrieval:  84%|████████▎ | 3508/4192 [00:00<00:00, 8804.87it/s]Sparse retrieval: 100%|██████████| 4192/4192 [00:00<00:00, 8805.56it/s]
10/14/2024 14:45:45 - INFO - __main__ -    Completed retrieval for dataset queries.
10/14/2024 14:45:45 - INFO - __main__ -    Evaluating MRR@k.
10/14/2024 14:45:45 - INFO - __main__ -    MRR@90: 0.3831
10/14/2024 14:45:45 - INFO - __main__ -    [Evaluation mrr] done in 26.882 s
10/14/2024 14:45:45 - INFO - __main__ -    Total execution time: 57.836 s
10/14/2024 14:45:45 - INFO - __main__ -    Sparse Retrieval System finished execution.
